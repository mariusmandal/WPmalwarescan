function loadBrowser(path) {
	if(path==undefined)
		path = '';
	jQuery('#malware_browser').html('Loading...');
	jQuery.post(ajaxurl, {'action':'malware_browser','path': path},
				function(response){
					jQuery('#malware_browser').html(response);
				}
				);	
}

function loadReport() {
	jQuery('#malware_report_red_container').html('Loading...');
	jQuery.post(ajaxurl, {'action':'malware_red'},
				function(response){
					jQuery('#malware_report_red_container').html(response);
				}
				);
}

function approveBelowThreshold() {
	var prompted = confirm('This will approve all files with two or less red flags. Continue?');
	if(prompted){
		jQuery.post(ajaxurl, {'action':'malware_fix_below_threshold'},
				function(response){
					loadReport();
					loadBrowser();
					jQuery('#malware_tool_threshold').attr('href','#');
					jQuery('#malware_tool_threshold').html(response);
				}
				);
	}
}

function approveOnlyPreg(){
	var prompted = confirm('This will approve all files flagged for "preg_"\'s only. Continue?');
	if(prompted){
		jQuery.post(ajaxurl, {'action':'malware_fix_preg'},
				function(response){
					loadReport();
					loadBrowser();
					jQuery('#malware_tool_preg').attr('href','#');
					jQuery('#malware_tool_preg').html(response);
				}
				);
	}
}

function approveFile(file) {
	jQuery('#malware_file_compare_contents').html('Loading, please wait...');

	jQuery.post(ajaxurl, {'action':'malware_approve_file','path':file},
			function(response){
				loadReport();
				malware_goback();
			}
			);
}


function compareFileManually(file){
	jQuery('#malware_dash_content').hide();
	jQuery('#malware_file_compare_contents').html('Loading file...');
	jQuery('#malware_file_compare').show();
	jQuery.post(ajaxurl, {'action':'malware_load_file', 'file':file},
				function(response){
					jQuery('#malware_file_compare_contents').html(response);
				}
			);
	
	
}

function malware_goback(){
	jQuery('#malware_file_compare').hide();
	jQuery('#malware_dash_content').show();
	
}

jQuery(document).ready(loadBrowser(),loadReport());